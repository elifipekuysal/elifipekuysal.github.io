<!DOCTYPE html>
<html lang="en">
<head>
  <title>PHP ile Local ve Public IP | Elif İpek Uysal</title>
  <meta charset="utf-8">
<meta name="description" content="  Merhabalar,   Bu yazıda "Bir siteyi ziyaret eden kişinin IP adresini nasıl elde edebiliriz ve bu IP adresini site üzerinde nasıl gösterebiliriz?" sorusuna yazdığım ufak bir PHP kodu ile cevap vermeye çalışacağım. Öncelikle PHP ile ilgili kısa bir bilgi edinelim.   Nedir bu PHP?   PHP, 1994 yılında Rasmus Lerdorf tarafından geliştirilmiştir. HTML …"><meta name="author" content="elifipekuysal">  <meta name="viewport" content="initial-scale=1, maximum-scale=1" />
  <meta http-equiv="Cache-Control" content="max-age=604800, must-revalidate" />
  <link href="/theme/css/screen.css" rel="stylesheet" type="text/css" />
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link href="/" type="application/atom+xml" rel="alternate" title="Elif İpek Uysal ATOM Feed" />
</head>
<body>
<div id="outer-wrapper">
<div id="header-wrapper">
  <div class="logo"><a href="https://elifipekuysal.github.io">ELIF IPEK UYSAL</a></div>
  <div class="small">Merhaba Dünya!</div>
    <div class="nav">
  <li><a href="/blogyazilari/">Blog Yazıları</a></li>
    </div>
    <div class="nav social">
<ul>
    <li><a href="https://github.com/elifipekuysal">Github</a></li>
    <li><a href="https://www.linkedin.com/in/elif-ipek-uysal-006316123?trk=nav_responsive_tab_profile_pic">Linkedin</a></li>
    <li><a href="https://twitter.com/elifipekuysal">Twitter</a></li>
</ul>    </div>
</div>    <div id="main">
<h2><a href="/php-ile-local-ve-public-ip.html">PHP ile Local ve Public IP</a></h2>
<h5><i class="icon-feather"></i> Thu 16 March 2017
<i class="icon-bookmarks"></i>
</h5>

<p>&nbsp; Merhabalar,  </p>
<p>&nbsp; Bu yazıda "<strong>Bir siteyi ziyaret eden kişinin IP adresini nasıl elde edebiliriz ve bu IP adresini site üzerinde nasıl gösterebiliriz?</strong>" sorusuna yazdığım ufak bir PHP kodu ile cevap vermeye çalışacağım. Öncelikle PHP ile ilgili kısa bir bilgi edinelim.  </p>
<h3> &nbsp; Nedir bu PHP? </h3>

<p>&nbsp; PHP, 1994 yılında Rasmus Lerdorf tarafından geliştirilmiştir. HTML içine gömülebilen ve <a href="https://www.chip.com.tr/haber/acik-kaynak-kod-nedir-size-de-gerekli-mi_38478.html">açık kaynak</a> kodlu bir <a href="https://tr.wikipedia.org/wiki/Betik_dili">betik dilidir</a>. Sözdiziminin çoğunu C, Java ve Perl'den almış olsa da betiği bu dillerden daha farklı bir yapıdadır. Sunucu tarafında çalıştırılan bir dildir. Yani, içinde PHP kodu barındıran bir siteye bağlanan kullanıcılar buradaki koda erişemez ve müdahale edemezler, yalnızca kodlar sonucu ortaya çıkan görseli görürler.    </p>
<p>&nbsp;  PHP kodu başlangıç etiketi olan <strong>&lt;?php</strong> ve bitiş etiketi olan <strong>?&gt;</strong> etiketleri arasına yazılır. Bu etiketler bir HTML dosyasının içinde "PHP kipine" geçişi sağlar. Buna bir örnek verecek olursak;  </p>
<div class="highlight"><pre><span class="cp">&lt;!DOCTYPE HTML&gt;</span>
<span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        ...Burada bazı HTML kodları bulunuyor...
    <span class="nt">&lt;/head&gt;</span>

    <span class="nt">&lt;body&gt;</span>
        <span class="cp">&lt;?php</span> 
            <span class="k">echo</span> <span class="s2">&quot;Merhaba, ben bir PHP betiğiyim!&quot;</span><span class="p">;</span>
        <span class="cp">?&gt;</span>
        ...Burada da HTML kodları bulunuyor...
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>


<p>&nbsp; Burada sayfa yüklenirken <strong>&lt;?php</strong> başlangıç etiketi görüldüğü anda PHP kipine geçiş yapılır ve <strong>?&gt;</strong> bitiş etiketini okuyana kadar gördüğü tüm kodları PHP kodu olarak ele alır. Sonuç olarak bu kod ekrana "Merhaba, ben bir PHP betiğiyim!" yazısını bastıracaktır.  </p>
<h3>Peki PHP kullanarak siteyi ziyaret eden kişinin IP adresine nasıl ulaşıyoruz?</h3>

<p>&nbsp; Ziyaretçinin IP adresine ulaşmaya genellikle güvenlik, doğrulama, spamları önleme gibi nedenlerle ihtiyaç duyabiliriz.<br>
&nbsp; PHP'de bunu elde etmek için başvurabileceğiniz iki farklı yol bulunmaktadır. Bu iki yol, değerlerin nasıl ve nereden alındığı konusundaki farkları dışında birbirleriyle aynı işlevi yerine getirirler. Bunlardan ilki olan <strong>getenv()</strong> PHP'deki ortam değişkenleri yardımıyla girilen parametrenin değerini döndürür ve ikincisi olan <strong>$_SERVER</strong> parametrenin değerini web sunucusundan (örneğin Apache) çeker.<br>
<fieldset>
&nbsp; <strong>$_SERVER</strong> başlıklar, yollar(path) ve betiklerin yerleri gibi bilgileri içeren bir dizidir ve bir web sunucusu (örneğin, Apache) tarafından oluşturulur. Bu dizideki girdiler HTTP sunucusu tarafından atanır. Kullanımı <strong><em>$_SERVER['parametre']</em></strong> şeklindedir.<br>
&nbsp; <strong>getenv()</strong> belirtilen bir ortam değişkeninin değerini döndürür. Kullanımı string <strong><em>getenv ('parametre')</em></strong> şeklindedir.<br>
</fieldset><br>
&nbsp; Proxy sunucusunu algılamaması, yani direkt local IP adresini çekmesi için, parametrenin olduğu kısma <strong>REMOTE_ADDR</strong> yazmalısınız. <strong>REMOTE_ADDR</strong> geçerli sayfayı görüntüleyen kullanıcının IP adresidir.<br>
&nbsp; Proxy sunucusunu algılaması, yani public IP adresini elde etmesi için ise <strong>HTTP_FORWARDED_FOR</strong> yazmalısınız. <strong>HTTP_FORWARDED_FOR</strong> proxy sunucusunun IP adresidir.  </p>
<p>&nbsp; Benim yazdığım HTML içine gömülmüş olan örnek PHP kodu şu şekilde:  </p>
<div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>

    <span class="nt">&lt;head&gt;</span>
        ...
    <span class="nt">&lt;/head&gt;</span>

    <span class="nt">&lt;body&gt;</span>
        ...
        <span class="cp">&lt;?php</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">getenv</span><span class="p">(</span><span class="s1">&#39;HTTP_FORWARDED_FOR&#39;</span><span class="p">))</span> <span class="p">{</span>
                <span class="nv">$localip</span> <span class="o">=</span> <span class="nb">getenv</span><span class="p">(</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">);</span>
                <span class="nv">$publicip</span> <span class="o">=</span> <span class="nb">getenv</span><span class="p">(</span><span class="s1">&#39;HTTP_FORWARDED_FOR&#39;</span><span class="p">);</span>
                <span class="k">echo</span> <span class="s2">&quot;Public IP&#39;niz : </span><span class="si">$publicip</span><span class="s2">&quot;</span> <span class="p">;</span>
                <span class="k">echo</span> <span class="s2">&quot;Local IP&#39;niz : </span><span class="si">$localip</span><span class="s2">&quot;</span> <span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nv">$localip</span> <span class="o">=</span> <span class="nb">getenv</span><span class="p">(</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">);</span>
                <span class="k">echo</span> <span class="s2">&quot;Local IP&#39;niz : </span><span class="si">$localip</span><span class="s2">&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="cp">?&gt;</span>   
        ...   
    <span class="nt">&lt;/body&gt;</span>

<span class="nt">&lt;/html&gt;</span>
</pre></div>


<p>&nbsp; Burada gerçekleşen işlemlerden kısaca bahsedecek olursak, siteye giren ziyaretçinin bir proxy sunucusu üzerinden girip girmediği kontrol ediliyor.  </p>
<p>&nbsp; Eğer proxy adresi üzerinden girmişse ortam değişkenleri yardımıyla local ve public IP adreslerinin değerlerini döndürüp, bu değerleri sırasıyla aynı isimli değişkenlere atıyor. Daha sonrasında ekrana şu çıktıyı veriyor:<br>
<center>
    "Public IP'niz : ..."<br>
    "Local IP'niz : ..." 
</center>  </p>
<p>&nbsp; Eğer proxy sunucusu üzerinden girmemişse direkt olarak local IP adresini değişkene atıyor ve şu çıktıyı veriyor:<br>
<center>
    "Local IP'niz : ..."
</center><br>
&nbsp; Sonuç olarak bu şekilde siteyi ziyaret eden kullanıcının IP adresine ulaşmış oluyorsunuz.  </p>
<p><center>&nbsp; Bu PHP kodunun tamamına ulaşmak için <a href="https://github.com/elifipekuysal/My-PHP-Codes/blob/master/publicandlocalip.php">tıklayın!</a></center></p>
<hr>
<p><center>
&nbsp; PHP ile ilgili daha fazla bilgi edinmek isterseniz aşağıdaki kaynaklardan yararlanabilirsiniz:<br>
<a href="http://php.net/manual/tr/intro-whatis.php">PHP Nedir?</a><br>
<a href="http://php.net/manual/tr/intro-whatcando.php">PHP Neler Yapabilir?</a><br>
<a href="http://php.net/manual/tr/history.php">PHP'nin Tarihçesi</a><br>
<a href="http://php.net/manual/tr/install.php">PHP'nin Kurulumu</a><br>
<a href="http://php.net/manual/tr/funcref.php">PHP'nin Önemli Özellikleri</a><br>
<a href="http://php.net/manual/tr/langref.php">PHP Dil Başvuru Kılavuzu</a><br>
<a href="http://php.net/manual/tr/features.php">PHP Kılavuzu</a><br>
</center></p>

<p align="center"><a href="#">on the top</a></p>
    </div>
</div>
<div id="footer-wrapper">
<ul class="footer">
</ul><ul class="footer">
    <li class="footer">&copy;&nbsp;2014&nbsp;::</li>
    <li class="footer"><a href="https://elifipekuysal.github.io"> ELIF IPEK UYSAL </a>&nbsp;::</li>
    <li class="footer">powered by <a href="https://github.com/getpelican">pelican</a>&nbsp;::</li>
    <li class="footer"><a href="http://creativecommons.org/licenses/by-nc/3.0/deed.ru">CC BY-NC</a></li>
</ul>
</div></body>
</html>